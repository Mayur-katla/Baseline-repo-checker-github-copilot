import React from 'react';
import { FiAlertTriangle } from 'react-icons/fi';

function Badge({ label, count, color }) {
  const cls = {
    red: 'bg-red-600/20 text-red-300 border-red-500/50',
    yellow: 'bg-yellow-600/20 text-yellow-300 border-yellow-500/50',
    blue: 'bg-blue-600/20 text-blue-300 border-blue-500/50',
    gray: 'bg-gray-700/20 text-gray-300 border-gray-600/50',
  }[color] || 'bg-gray-700/20 text-gray-300 border-gray-600/50';
  return (
    <span className={`text-xs px-2 py-1 rounded-full border ${cls} mr-2`}>{label}: {count}</span>
  );
}

export default function VulnerabilitySummary({ data = {} }) {
  const summary = data?.vulnSeveritySummary || {};
  const counts = {
    critical: summary.critical || 0,
    high: summary.high || 0,
    moderate: summary.moderate || 0,
    low: summary.low || 0,
    unknown: summary.unknown || 0,
  };

  const total = counts.critical + counts.high + counts.moderate + counts.low + counts.unknown;
  if (total === 0) {
    return null;
  }

  return (
    <div className="bg-gray-800/50 backdrop-blur-md rounded-xl p-4 border border-gray-700/50 mb-4">
      <div className="flex items-start gap-3 mb-2">
        <div className="p-3 rounded-full bg-indigo-500/20 text-indigo-300"><FiAlertTriangle /></div>
        <div>
          <h3 className="text-lg font-semibold text-white">Vulnerability Severity Summary</h3>
          <p className="text-xs text-gray-400">Aggregated from npm audit results.</p>
        </div>
      </div>
      <div className="flex flex-wrap gap-2">
        <Badge label="Critical" count={counts.critical} color="red" />
        <Badge label="High" count={counts.high} color="red" />
        <Badge label="Moderate" count={counts.moderate} color="yellow" />
        <Badge label="Low" count={counts.low} color="blue" />
        <Badge label="Unknown" count={counts.unknown} color="gray" />
      </div>
    </div>
  );
}